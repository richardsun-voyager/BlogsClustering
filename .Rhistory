dim(dt)
dt<-rbind(unigram_dt,bigram_dt,trigram_dt)#Combine them
dt<-t(dt)#Transpose it, now each row stands for a blog, and each column stands for a keyword
hc<-hclust(dist(dt),method="complete")
result<-cutree(hc,k=2)
plot(result)
plot(hc)
result<-cutree(hc,k=8)
plot(result)
result<-cutree(hc,k=12)
plot(result)
plot(mean(dt1))
plot(y=mean(dt1))
plot(x=1:dim(dt1)[1],y=mean(dt1))
y=mean(dt1)
y
dt1
names(dt1)
dt1<-dt[type==1,]
dt2<-dt[type!=1,]
names(dt1)
type<-km$cluster
dim(dt1)
dim(dt2)
names(dt2)
names(dt)
summary(dt)
colnames(dt)
class(dt)
class(unigram_dt)
dt<-data.frame(dt)
class(dt)
names(dt)
dt<-data.frame(dt)
rownames(dt)[1]
barplot(summary(dt1))
dt1<-dt[type==1,]
dt2<-dt[type!=1,]
dim(dt1)
dim(dt2)
barplot(summary(dt1))
barplot(mean(dt1))
names(dt1)
boxplot(dt1)
boxplot(dt2)
?boxplot
library(ggplot2)
qplot(dt1)
install.packages('igraph')
library(igraph)
g <- graph.adjacency(tdm, mode="undirected")
g <-graph.adjacency(tdm, mode="undirected")
termMatrix <-tdm %*% t(tdm)
?qplot
library(lattice)
?xyplot
xyplot(Sepal.Length + Sepal.Width ~ Petal.Length + Petal.Width | Species,
data = iris, scales = "free", layout = c(2, 2),
auto.key = list(x = .6, y = .7, corner = c(0, 0)))
xyplot(dt1)
xyplot(type,data=dt)
barchart
barchart(dt1)
boxplot(good+web~type,data=dt)
dim(dt)
length(type)
index<-dt_pca2[,1]>400
dt_pca2<-dt_pca2[!index,]
dt<-dt[!index,]
boxplot(good+web~type,data=dt)
dim(dt)
dt_pca2<-dt_pca$x[,1:2]
plot(dt_pca2,main="First Two Components of Keyword Weights in Blogs")
sum(index)
dt_pca2<-dt_pca$x[,1:2]
index<-dt_pca2[,1]>400
sum(index)
dt_pca2<-dt_pca2[!index,]
dt<-dt[!index,]
boxplot(good+web~type,data=dt)
boxplot(web~type,data=dt)
xyplot(good|type,data=dt)
xyplot(dt$good|type,data=dt)
class(dt$good)
head(dt1)
boxplot(as.matrix(dt1[,1:10]))
?par
par(mfrow=c(1,2))
boxplot(as.matrix(dt1[,1:10]))
boxplot(as.matrix(dt2[,1:10]))
par(mfrow=c(2,1))
boxplot(as.matrix(dt1[,1:10]))
boxplot(as.matrix(dt2[,1:10]))
?boxplot
boxplot(as.matrix(dt1[,1:10]),outlinr=F)
boxplot(as.matrix(dt2[,1:10]),outlinr=F)
par(mfrow=c(2,1))
boxplot(as.matrix(dt1[,1:10]),outlinr=F)
boxplot(as.matrix(dt2[,1:10]),outlinr=F)
par(mfrow=c(2,1))
boxplot(as.matrix(dt1[,1:10]),outline=F)
boxplot(as.matrix(dt2[,1:10]),outline=F)
boxplot(as.matrix(dt[,1:10])~type,col=type,outline=F)
boxplot(as.matrix(dt1[,1:10]),outline=F)
boxplot(as.matrix(dt2[,1:10]),outline=F)
boxplot(as.matrix(dt1[,1:10]),outline=F,ylim(0,12))
boxplot(as.matrix(dt2[,1:10]),outline=F,ylim(0,12))
boxplot(as.matrix(dt2[,1:10]),outline=F,ylim=c(0,12))
par(mfrow=c(2,1))
boxplot(as.matrix(dt1[,1:10]),outline=F,ylim=c(0,12))
boxplot(as.matrix(dt2[,1:10]),outline=F,ylim=c(0,12))
hc<-hclust(dist(dt),method="complete")
plot(hc)
result<-cutree(hc,k=12)
plot(result)
result
sum(result==1)
length(result)
result<-cutree(hc,k=2)
plot(result)
result<-cutree(hc,k=20)
plot(result)
sum(result==1)
result<-cutree(hc,k=50)
plot(result)
sum(result==1)
?biplot
boxplot(as.matrix(dt1[,1:10]),outline=F,ylim=c(0,12))
biplot(as.matrix(dt2[,1:10]),outline=F,ylim=c(0,12))
par(mfrow=c(2,1))
boxplot(as.matrix(dt1[,1:10]),outline=F,ylim=c(0,12),xlab="Keywords",ylab="TfIdf Weights")
boxplot(as.matrix(dt2[,1:10]),outline=F,ylim=c(0,12),xlab="Keywords",ylab="TfIdf Weights")
termMatrix <-tdm %*% t(tdm)
dt1[1,]
summary(dt1)
summary(dt2)
cor(dt1)
a=cor(dt1)
max(a)
a=a[a>0.5,]
a=rownames(dt1)
head(a)
a=lapply(rownames(dt1),strip,"X.")
t="wedd"
?strip
strstrip(t,"e")
?string
??strip
?sub
sub("e","",t)
a=lapply(rownames(dt1),sub,"X.","")
a[[1]]
a=rownames(dt1)
a[1]
a=lapply(rownames(dt1),sub,"x.","")
a[1]
a[2]
substr<-function(line){sub("x.","",line)}
files<-lapply(rownames(dt1),substr)
head(files)
substr<-function(line){sub("X.","",line)}
files<-lapply(rownames(dt1),substr)
head(files)
substr<-function(line){sub("^X.","",line)}
files<-lapply(rownames(dt1),substr)
head(files)
files1<-lapply(rownames(dt1),substr)#Remove the first letters of file names
files2<-lapply(rownames(dt2),substr)#Remove the first letters of file names
files1_original<-list.files("DSC")
files1_original<-list.files("DSC")
files2_original<-list.files("AnalyticBridge")
a=c("d","e","f")
b=c("d","f","g")
a %in% b
b=c("d","f","g","h")
a %in% b
sum(files1 %in% files1_original)
head(files1,100)
blogs
summary(blogs)
blogMeta<-tm_map(blogs,meta)#find out meta data of each blog, which has names of blogs
library(tm)
blogMeta<-tm_map(blogs,meta)#find out meta data of each blog, which has names of blogs
getId<-function(metadata){id<-metadata['id']}#The metadata id specifies the text names
blogNames<-sapply(blogMeta$content,getId)#Get the id of each blog
summary(blogNames)
head(files1,20)
files1_original[1:20]
library(tm)
a=removePunctuation(files1)
help(package=tm)
a=removePunctuation(unlist(files1)
)
heand(a)
head(a)
files1<-removePuncutation(unlist(files1))
files2<-removePuncutation(unlist(files2))
files1<-removePunctuation(unlist(files1))
files2<-removePunctuation(unlist(files2))
files1_original<-removePunctuation(files1_original)
files2_original<-removePunctuation(files2_original)
sum(files1 %in% files1_original)
length(files1)
sum(files2 %in% files2_original)
sum(files1 %in% files1_original)/length(files1)
sum(files2 %in% files1_original)/length(files2)
sum(files1 %in% files2_original)/length(files1)
sum(files2 %in% files2_original)/length(files2)
sum(files1 %in% files1_original)/length(files1)
sum(files2 %in% files1_original)/length(files2)
sum(files1 %in% files2_original)/length(files1)
sum(files2 %in% files2_original)/length(files2)
summary(dt1)
summary(dt2)
par(mfrow=c(2,1))
boxplot(as.matrix(dt1[,1:10]),outline=F,ylim=c(0,12),xlab="Keywords",ylab="TfIdf Weights")
boxplot(as.matrix(dt2[,1:10]),outline=F,ylim=c(0,12),xlab="Keywords",ylab="TfIdf Weights")
hc<-hclust(dist(dt),method="wards.D")
result<-cutree(hc,k=2)
plot(result)
?hclust
hc<-hclust(dist(dt),method="ward.D")
result<-cutree(hc,k=2)
plot(result)
par(mfrow=c(2,1))
hc<-hclust(dist(dt),method="ward.D")
result<-cutree(hc,k=2)
plot(result)
result<-cutree(hc,k=10)
plot(result)
result<-cutree(hc,k=2)
result
a=result[result==1]
length(a)
dim(dt1)
dt1<-dt[result==1,]
dt2<-dt[result!=1,]
files1<-lapply(rownames(dt1),substr)#Remove the first letters of file names
files2<-lapply(rownames(dt2),substr)#Remove the first letters of file names
files1<-removePunctuation(unlist(files1))#Remove the punctuations
files2<-removePunctuation(unlist(files2))
files1_original<-list.files("DSC")#Blogs from DSC
files2_original<-list.files("AnalyticBridge")#Blogs from AB
files1_original<-removePunctuation(files1_original)#Remove the punctuations
files2_original<-removePunctuation(files2_original)
library(tm)
files1<-lapply(rownames(dt1),substr)#Remove the first letters of file names
files2<-lapply(rownames(dt2),substr)#Remove the first letters of file names
files1<-removePunctuation(unlist(files1))#Remove the punctuations
files2<-removePunctuation(unlist(files2))
files1_original<-list.files("DSC")#Blogs from DSC
files2_original<-list.files("AnalyticBridge")#Blogs from AB
files1_original<-removePunctuation(files1_original)#Remove the punctuations
files2_original<-removePunctuation(files2_original)
sum(files1 %in% files1_original)/length(files1)
sum(files2 %in% files1_original)/length(files2)
sum(files1 %in% files2_original)/length(files1)
sum(files2 %in% files2_original)/length(files2)
summary(result)
sum(result==1)
mean(dt1)
apply(dt1,2,mean)
apply(dt2,2,mean)
km<-kmeans(dt,centers=3,iter.max=100)
km$centers
plot(dt_pca2,col=km$cluster,main="First Two Components of Keyword Weights in Blogs")
?legend
sum(result==1)
km<-kmeans(dt,centers=2,iter.max=100)
km$centers
plot(dt_pca2,col=km$cluster,main="First Two Components of Keyword Weights in Blogs")
par(mfrow=c(2,1))
hc<-hclust(dist(dt),method="ward.D")
result<-cutree(hc,k=10)
plot(result)
result<-cutree(hc,k=2)
plot(result)
sum(result==1)
dt1<-dt[result==1,]
dt2<-dt[result!=1,]
sum(result!=1)
result
dt1<-dt[result==1,]
dt2<-dt[result!=1,]
mean(dt1)
plot(dt_pca2,col=result,main="First Two Components of Keyword Weights in Blogs")
plot(dt_pca2,col=result,main="First Two Components of Keyword Weights in Blogs")
plot(dt_pca2,col=result,main="First Two Components of Keyword Weights in Blogs")
head(dt1)
names(dt1)
summary(dt1)
apply(dt1,1,mean)
apply(dt1,2,mean)
apply(dt2,2,mean)
km$centers
par(mfrow=c(2,1))
hc<-hclust(dist(dt),method="ward.D")
result<-cutree(hc,k=2)
plot(result)
plot(dt_pca2,col=result,main="First Two Components of Keyword Weights in Blogs")
sum(result==1)
sum(result!=1)
dt1<-dt[result==1,]
apply(dt1,2,mean)
dt2<-dt[result!=1,]
apply(dt2,2,mean)
sum(result!=1)
km$cluster
type<-km$cluster
sum(type==1)
apply(dt2,2,mean)
apply(dt2,2,var)
type<-km$cluster
dt$type<-type
dt1<-dt[type==1,]
dt2<-dt[type!=1,]
apply(dt2,2,var)
type<-km$cluster
dt1<-dt[type==1,]
dt2<-dt[type!=1,]
barplot(km$centers)
km$centers
plot(dt_pca2,col=km$cluster,main="First Two Components of Keyword Weights in Blogs")
barplot(km$centers)
class(km$centers)
dt3<-dt[result==1,]
means3<-apply(dt3,2,mean)
dt4<-dt[result!=1,]
means4<-apply(dt4,2,mean)
barplot(means3,means4)
centers<-data.frame(km$centers)
summary(centers)
head(centers)
centers<-rbind(centers,means3,means4)
barplot(centers)
centers<-km$centers
barplot(centers,xlab="Key Terms",ylab="Average Weights","Comparsion of Centers")
barplot(centers,xlab="Key Terms",ylab="Average Weights","Comparsion of Centers")
centers<-km$centers
barplot(centers,xlab="Key Terms",ylab="Average Weights","Comparsion of Centers")
centers
barplot(km$centers,xlab="Key Terms",ylab="Average Weights","Comparsion of Centers")
barplot(centers,xlab="Key Terms",ylab="Average Weights",main="Comparsion of Centers")
centers<-rbind(centers,means3,means4)
class(means3)
centers<-as.matrix(means3,means4)
barplot(centers)
barplot(means3,means4)
centers<-data.frame(km$centers)
centers<rbind(centers,means3,means4)
centers<-data.frame(km$centers)
centers<rbind(centers,means3,means4)
centers_hr<-data.frame(means3)
centers_hr
?matrix
a=matrix(means3)
a
a=as.matrix(means3)
a
means3
class(means3)
a=matrix(means,byrow=T)
a=matrix(means3,byrow=T)
a
a=matrix(means3,byrow=F,dimnames=names(means3))
names(mean3)
names(means3)
dt$type<-NULL
a=matrix(means3,byrow=F,dimnames=names(means3))
?as.matrix
a=as.matrix(means3)
a
a=as.matrix(means3,byrow=T)
a
a=as.matrix(means3,byrow=F)
a
dt3<-dt[result==1,]
means3<-apply(dt3,2,mean)
dt4<-dt[result!=1,]
means4<-apply(dt4,2,mean)
rbind(means3,means4)
centers_hr<-rbind(means3,means4)
barplot(centers_hr,xlab="Key Terms",ylab="Average Weights",main="Comparsion of Centers")
var3<-apply(dt3,2,var)
var4<-apply(dt4,2,var)
var_hr<-rbind(var3,var4)
barplot(var_hr,xlab="Key Terms",ylab="Average Weights",main="Comparsion of Centers")
var1<-apply(dt1,2,var)
var2<-apply(dt2,2,var)
var_hr<-rbind(var1,var2)
barplot(var_hr,xlab="Key Terms",ylab="Average Weights",main="Comparsion of Centers")
plot(dt_pca2,col=km$cluster,main="First Two Components of Keyword Weights in Blogs")
legend("topright",pch=1,col=km$cluster,,legend = c("Type I", "Type II"))
plot(dt_pca2,col=km$cluster,main="First Two Components of Keyword Weights in Blogs")
legend("topright",pch=1,col=c("black","red"),,legend = c("Type I", "Type II"))
sum(type==1)
km$centers
plot(dt_pca2[type==1])
plot(dt_pca2,col=km$cluster,main="First Two Components of Keyword Weights in Blogs")
plot(dt_pca2,col=km$cluster,main="First Two Components of Keyword Weights in Blogs")
legend("topright",pch=1,col=c("black","red"),legend = c("Type II", "Type I"))
plot(dt_pca2,col=km$cluster,main="First Two Components of Keyword Weights in Blogs")
legend("topright",pch=1,col=c("black","red"),legend = c("Type I", "Type IT"))
barplot(km$centers,xlab="Key Terms",ylab="Average Weights",main="Comparsion of Centers")
barplot(km$centers,xlab="Key Terms",ylab="Average Weights",main="Comparsion of Centers",legend=km$cluster)
barplot(km$centers,xlab="Key Terms",ylab="Average Weights",main="Comparsion of Centers",legend=unique(km$cluster))
plot(dt_pca2,col=result,main="First Two Components of Keyword Weights in Blogs",legend=unique(result))
plot(dt_pca2,col=result,main="First Two Components of Keyword Weights in Blogs")
legend("topright",pch=1,col=c("black","red"),legend = c("Type I", "Type II"))
barplot(centers_hr,xlab="Key Terms",ylab="Average Weights",main="Comparsion of Centers")
barplot(var_hr,xlab="Key Terms",ylab="Average Weights",main="Comparsion of Centers")
var_hr<-rbind(var3,var4)
barplot(var_hr,xlab="Key Terms",ylab="Average Weights",main="Comparsion of Centers")
?legend
km<-kmeans(dt,centers=2,iter.max=100)
km$centers
plot(dt_pca2,col=km$cluster,main="First Two Components of Keyword Weights in Blogs")
legend("topright",pch=1,col=c("black","red"),legend = c("Type I", "Type II"))
barplot(km$centers,xlab="Key Terms",ylab="Average Weights",main="Comparsion of Centers",legend=unique(km$cluster))
barplot(var_hr,xlab="Key Terms",ylab="Weight Variance",main="Comparsion of Centers")
hc<-hclust(dist(dt),method="ward.D")
result<-cutree(hc,k=2)
plot(result,xlab="Blog Index",ylab="Type",main="Clustering Result")
plot(dt_pca2,col=result,main="First Two Components of Keyword Weights in Blogs")
legend("topright",pch=1,col=c("black","red"),legend = c("Type I", "Type II"))
dt3<-dt[result==1,]#The first type
dt4<-dt[result!=1,]#The other type
means3<-apply(dt3,2,mean)
means4<-apply(dt4,2,mean)
centers_hr<-rbind(means3,means4)
barplot(centers_hr,xlab="Key Terms",ylab="Average Weights",main="Comparsion of Centers")
var3<-apply(dt3,2,var)
var4<-apply(dt4,2,var)
var_hr<-rbind(var3,var4)
barplot(var_hr,xlab="Key Terms",ylab="Average Weights",main="Comparsion of Centers")
barplot(centers_hr,xlab="Key Terms",ylab="Average Weights",main="Comparsion of Centers",lengend=unique(result))
barplot(centers_hr,xlab="Key Terms",ylab="Average Weights",main="Comparsion of Centers",lengend=unique(centers_hr))
barplot(km$centers,xlab="Key Terms",ylab="Average Weights",main="Comparsion of Centers",legend=unique(km$cluster))
barplot(var_hr,xlab="Key Terms",ylab="Weight Variance",main="Comparsion of Centers")
legend("topright",pch=1,col=c("black","red"),legend = c("Type I", "Type II"))
km<-kmeans(dt,centers=2,iter.max=100)
km$centers
plot(dt_pca2,col=km$cluster,main="First Two Components of Keyword Weights in Blogs")
legend("topright",pch=1,col=c("black","red"),legend = c("Type I", "Type II"))
barplot(km$centers,xlab="Key Terms",ylab="Average Weights",main="Comparsion of Centers",legend=unique(km$cluster))
sum(km$cluster==1)
sum(km$cluster==1)#Count of first type
sum(km$cluster!=1)#count of second type
legend("topright",pch=1,col=c("black","red"),legend = c("Type I", "Type II"))
plot(dt_pca2,col=km$cluster,main="First Two Components of Keyword Weights in Blogs")
plot(dt_pca2,col=km$cluster,main="First Two Components of Keyword Weights in Blogs")
legend("topright",pch=1,col=c("black","red"),legend = c("Type I", "Type II"))
?point
dt_pca
summary(dt_pca)
names(dt_pca)
dt_pca$rotation
?prcomp
predict(dt_pca,km$centersa=)
a=predict(dt_pca,km$centers)
a=predict(dt_pca,data.frame(km$centers)
)
a=data.frame(km$centers)
a
names(dt)
b=predict(dt_pca,a)
names(a)
b=predict(dt_pca,a)
b=predict(dt_pca,dt)
?predict.prcomp
plot(prcomp(USArrests))
b=dt_pca$rotation*a
b
plot(dt_pca2,col=km$cluster,main="First Two Components of Keyword Weights in Blogs")
legend("topright",pch=1,col=c("black","red"),legend = c("Type I", "Type II"))
points(b,pca=3)
points(b,pch=3)
class(b)
points(as.matrix(b),pch=3)
points(as.matrix(b),pch=3,col=1:2)
points(b[,1:2],pch=3,col=1:2)
b=dt_pca$rotation %*% a
a
biplot(dt_pca)
biplot(dt_pca)
barplot(km$centers,xlab="Key Terms",ylab="Average Weights",main="Comparsion of Centers",legend=unique(km$cluster))
barplot(var_hr,xlab="Key Terms",ylab="Weight Variance",main="Comparsion of Centers")
plot(dt_pca2,col=result,main="First Two Components of Keyword Weights in Blogs")
sum(result==1)
sum(km$cluster==1)#Count of first type
legend("topright",pch=1,col=c("black","red"),legend = c("Type I", "Type II"))
barplot(centers_hr,xlab="Key Terms",ylab="Average Weights",main="Comparsion of Centers")
barplot(var_hr,xlab="Key Terms",ylab="Average Weights",main="Comparsion of Centers")
dt1<-dt[type==1,]
dt2<-dt[type!=1,]
var1<-apply(dt1,2,var)
var2<-apply(dt2,2,var)
var_hr<-rbind(var1,var2)
barplot(var_hr,xlab="Key Terms",ylab="Weight Variance",main="Comparsion of Centers")
barplot(km$centers,xlab="Key Terms",ylab="Average Weights",main="Comparsion of Centers",legend=unique(km$cluster))
barplot(var_hr,xlab="Key Terms",ylab="Weight Variance",main="Comparsion of Variances")
plot(dt_pca2,col=result,main="First Two Components of Keyword Weights in Blogs")
legend("topright",pch=1,col=c("black","red"),legend = c("Type I", "Type II"))
var_hr<-rbind(var3,var4)
barplot(var_hr,xlab="Key Terms",ylab="Average Weights",main="Comparsion of Variances")
var_hr<-rbind(var1,var2)
barplot(var_hr,xlab="Key Terms",ylab="Weight Variance",main="Comparsion of Variances")
barplot(centers_hr,xlab="Key Terms",ylab="Average Weights",main="Comparsion of Centers")
anova(dt3,dt4)
barplot(var_hr,xlab="Key Terms",ylab="Average Weights",main="Comparsion of Variances")
var_hr<-rbind(var3,var4)
barplot(var_hr,xlab="Key Terms",ylab="Average Weights",main="Comparsion of Variances")
